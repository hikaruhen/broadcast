<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="utf-8" />
  <title>Áè≠Á¥öÁÑ°ËÅ≤Âª£Êí≠Á≥ªÁµ±</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="icon-192.png" rel="icon" />
  <link href="icon-192.png" rel="apple-touch-icon" />
  <style>
    body { margin: 0; padding: 0; font-family: "Microsoft JhengHei", sans-serif; overflow: hidden; color: #fff; }
    .background { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; }
    .background img { position: absolute; width: 100%; height: 100%; object-fit: cover; opacity: 0; transition: opacity 2s; }
    .background img.active { opacity: 1; }
    .time { font-size: 2em; text-align: center; padding: 10px; }
    .content { position: absolute; top: 60px; bottom: 80px; width: 100%; display: flex; justify-content: center; align-items: center; }
    .page { display: none; font-size: 2em; text-align: center; padding: 20px; background-color: rgba(0, 0, 0, 0.5); border-radius: 20px; word-break: break-word; white-space: normal; }
    .page.active { display: block; }
    .marquee { position: fixed; bottom: 0; width: 100%; background: rgba(0, 0, 0, 0.7); color: #ff0; font-size: 1.5em; white-space: nowrap; overflow: hidden; }
    .marquee-content { display: inline-block; padding-left: 100%; animation: scroll-left 25s linear infinite; }
    @keyframes scroll-left { from { transform: translateX(0%); } to { transform: translateX(-100%); } }
    #garbage-mode, #cleaning-mode {
      display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: black; z-index: 999; justify-content: center; align-items: center; flex-direction: column;
    }
    #garbage-mode img, #cleaning-mode img { max-width: 80%; height: auto; }
    #sound-indicator {
      position: fixed; bottom: 10px; right: 10px; z-index: 9999;
      opacity: 0.6; width: 40px; height: 40px; display: none; pointer-events: none;
    }
  </style>
</head>
<body>
<img class="persistent-ui" id="sound-indicator" src="sound-icon.png"/>
<button id="sound-auth-btn" style="position:fixed; top:0; left:0; width:100vw; height:100vh; opacity:0; z-index:10000;">Èªû‰∏Ä‰∏ã‰ª•ÂïüÁî®Èü≥Êïà</button>
<div class="background"><img class="active" src="be01.jpg"/></div>
<div class="time" id="clock">ËºâÂÖ•‰∏≠...</div>
<div class="content" id="announcement-area"><div class="page active">üì¢ ÁÑ°ËÅ≤Âª£Êí≠È¶ñÈ†Å</div></div>
<div class="marquee"><div class="marquee-content" id="marquee-text">ËºâÂÖ•‰∏≠...</div></div>
<div id="garbage-mode"><img src="gomidashi_woman.png"/><audio id="garbage-music" loop><source src="prayer.mp3" type="audio/mpeg"/></audio></div>
<div id="cleaning-mode"><img src="cleaning_time.png" /></div>
<script>
let userExitPlayback = false;
document.addEventListener("click", () => {
  const garbageDiv = document.getElementById("garbage-mode");
  const cleaningDiv = document.getElementById("cleaning-mode");
  const music = document.getElementById("garbage-music");
  const allContent = document.body.querySelectorAll("body > *:not(#garbage-mode):not(.persistent-ui):not(#cleaning-mode)");
  if (garbageDiv.style.display === "flex" || cleaningDiv.style.display === "flex") {
    userExitPlayback = true;
    garbageDiv.style.display = "none";
    cleaningDiv.style.display = "none";
    allContent.forEach(el => el.style.display = "");
    if (!music.paused) { music.pause(); music.currentTime = 0; }
    console.log("üñ±Ô∏è ‰ΩøÁî®ËÄÖÈªûÊìäÔºå‰∏≠Êñ∑Êí≠ÊîæÁï´Èù¢");
  }
});
const music = document.getElementById("garbage-music");
const authBtn = document.getElementById("sound-auth-btn");
authBtn.addEventListener("click", () => {
  music.play().then(() => {
    music.pause(); music.currentTime = 0;
    console.log("üîä Êí≠ÊîæÊéàÊ¨äÊàêÂäü");
    document.getElementById('sound-indicator').style.display = 'block'; authBtn.remove();
  }).catch(err => console.log("‚ö†Ô∏è Êí≠ÊîæÊéàÊ¨äÂ§±Êïó", err));
});
function updateClock() {
  const now = new Date();
  const days = ['Êó•','‰∏Ä','‰∫å','‰∏â','Âõõ','‰∫î','ÂÖ≠'];
  const formatted = now.getFullYear() + '-' + String(now.getMonth()+1).padStart(2,'0') + '-' + String(now.getDate()).padStart(2,'0') + 'Ôºà' + days[now.getDay()] + 'Ôºâ ' + String(now.getHours()).padStart(2,'0') + ':' + String(now.getMinutes()).padStart(2,'0') + ':' + String(now.getSeconds()).padStart(2,'0');
  document.getElementById('clock').textContent = formatted;
}
setInterval(updateClock, 1000);
setInterval(() => { location.reload(); }, 20 * 60 * 1000);
updateClock();
setInterval(() => {
  const now = new Date(); const h = now.getHours(); const m = now.getMinutes();
  const isCleaningTime = (h === 14 && m >= 51) || (h === 15 && m <= 5);
  const isGarbageTime = h === 12 && m === 20;
  const garbageDiv = document.getElementById("garbage-mode");
  const cleaningDiv = document.getElementById("cleaning-mode");
  const allContent = document.body.querySelectorAll("body > *:not(#garbage-mode):not(.persistent-ui):not(#cleaning-mode)");
  if (isGarbageTime && !userExitPlayback) {
    garbageDiv.style.display = "flex";
    allContent.forEach(el => el.style.display = "none");
    if (music && music.paused) { music.muted = false; music.play().catch(() => console.log("Èü≥Ê®ÇÊí≠ÊîæË¢´ÈòªÊìã")); }
  } else {
    garbageDiv.style.display = "none";
    if (!isCleaningTime && !isGarbageTime) userExitPlayback = false;
    allContent.forEach(el => el.style.display = "");
    if (music && !music.paused) { music.pause(); music.currentTime = 0; }
  }
  if (isCleaningTime && !userExitPlayback) {
    console.log("üßπ Ê∏ÖÊéÉÊôÇÈñìËß∏Áôº", h + ":" + m);
    cleaningDiv.style.display = "flex";
    if (!garbageDiv || garbageDiv.style.display !== "flex") {
      allContent.forEach(el => el.style.display = "none");
    }
  } else {
    cleaningDiv.style.display = "none";
    if (!isCleaningTime && !isGarbageTime) userExitPlayback = false;
    if (!garbageDiv || garbageDiv.style.display !== "flex") {
      allContent.forEach(el => el.style.display = "");
    }
  }
}, 1000);
</script>
</body>
</html>
