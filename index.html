
<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <!-- headå€å¡Šï¼šåŒ…å«ç¶²é çš„åŸºæœ¬è³‡è¨Šèˆ‡å¼•å…¥ manifestï¼ˆPWAè¨­å®šï¼‰ -->
  <meta charset="UTF-8">
  <title>ç­ç´šç„¡è²å»£æ’­ç³»çµ±</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: "Microsoft JhengHei", sans-serif;
      overflow: hidden;
      color: #fff;
    }
    .background {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      z-index: -1;
    }
    .background img {
      position: absolute;
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: 0;
      transition: opacity 2s;
    }
    .background img.active {
      opacity: 1;
    }
    .time {
      font-size: 2em;
      text-align: center;
      padding: 10px;
    }
    .content {
      position: absolute;
      top: 60px;
      bottom: 80px;
      width: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .page {
      display: none;
      font-size: 2em;
      text-align: center;
      padding: 20px;
      background-color: rgba(0, 0, 0, 0.5);
      border-radius: 20px;
      word-break: break-word;
      white-space: normal;
    }
    .page.active {
      display: block;
    }
    .marquee {
      position: fixed;
      bottom: 0;
      width: 100%;
      background: rgba(0, 0, 0, 0.7);
      color: #ff0;
      font-size: 1.5em;
      white-space: nowrap;
      overflow: hidden;
    }
    .marquee-content {
      display: inline-block;
      padding-left: 100%;
      animation: scroll-left 15s linear infinite;
    }
    @keyframes scroll-left {
      from { transform: translateX(0%); }
      to { transform: translateX(-100%); }
    }

    #garbage-mode {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: black;
      z-index: 999;
      justify-content: center;
      align-items: center;
      flex-direction: column;
    }
    #garbage-mode img {
      max-width: 80%;
      height: auto;
    }
  </style>
</head>
<body>
  
  <!-- èƒŒæ™¯åœ–ç‰‡å®¹å™¨ï¼Œæœƒè‡ªå‹•è¼ªæ’­ï¼Œåœ–ç‰‡æ”¾åœ¨ <img> è£¡ï¼Œä¸¦é€é JS å®šæ™‚åˆ‡æ› .active -->
  <div class="background">
    <img src="https://raw.githubusercontent.com/hikaruhen/broadcast/main/be01.jpg" class="active">
    <img src="https://raw.githubusercontent.com/hikaruhen/broadcast/main/be02.jpg">
    <img src="https://raw.githubusercontent.com/hikaruhen/broadcast/main/be03.jpg">
    <img src="https://raw.githubusercontent.com/hikaruhen/broadcast/main/be04.jpg">
    <img src="https://raw.githubusercontent.com/hikaruhen/broadcast/main/be05.jpg">
    <img src="https://raw.githubusercontent.com/hikaruhen/broadcast/main/be06.jpg">
    <img src="https://raw.githubusercontent.com/hikaruhen/broadcast/main/be07.jpg">
    <img src="https://raw.githubusercontent.com/hikaruhen/broadcast/main/be08.jpg">
    <img src="https://raw.githubusercontent.com/hikaruhen/broadcast/main/be09.jpg">
  </div>

  
  <!-- é¡¯ç¤ºç•¶å‰æ™‚é–“çš„å€å¡Šï¼Œå…§å®¹ç”± JS æ¯ç§’æ›´æ–° -->
  <div class="time" id="clock">è¼‰å…¥ä¸­...</div>

  
  <!-- å»£æ’­ä¸»è¦å…§å®¹é¡¯ç¤ºå€å¡Šï¼Œæœƒç”± Google Sheets å–å¾—å…§å®¹ä¸¦è¼ªæ’­ -->
  <div class="content" id="announcement-area">
    <div class="page active">ğŸ“¢ ç„¡è²å»£æ’­é¦–é </div>
  </div>

  
  <!-- è·‘é¦¬ç‡ˆå€å¡Šï¼Œæœƒå¾ Google Sheets B æ¬„è¼‰å…¥è³‡æ–™ä¸¦æ©«å‘æ»¾å‹• -->
  <div class="marquee">
    <div class="marquee-content" id="marquee-text">è¼‰å…¥ä¸­...</div>
  </div>

  
  <!-- åƒåœ¾è»Šæ¨¡å¼å€å¡Šï¼šåœ¨ç‰¹å®šæ™‚é–“ï¼ˆ12:20ï¼‰é¡¯ç¤ºåœ–ç‰‡ä¸¦æ’­æ”¾éŸ³æ¨‚ -->
  <div id="garbage-mode">
    <img src="gomidashi_woman.png" alt="åƒåœ¾è»Šæé†’">
    <audio id="garbage-music" loop>
      <source src="prayer.mp3" type="audio/mpeg">
    </audio>
<script>
  // æå‰æ’­æ”¾æˆæ¬Šï¼ˆéœéŸ³é æ’­ï¼‰
  window.addEventListener("load", () => {
    const music = document.getElementById("garbage-music");
    if (music) {
      music.play().then(() => {
        music.pause();
        music.currentTime = 0;
        console.log("ğŸ”Š æ’­æ”¾æˆæ¬Šå·²ç²å¾—");
      }).catch(err => console.log("âš ï¸ æ’­æ”¾æˆæ¬Šå¤±æ•—ï¼Œéœ€ä½¿ç”¨è€…äº’å‹•"));  
    }
  });
</script>
  </div>

  <script>
    function updateClock() {
      const now = new Date();
      const days = ['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­'];
      const formatted = now.getFullYear() + '-' +
                        String(now.getMonth() + 1).padStart(2, '0') + '-' +
                        String(now.getDate()).padStart(2, '0') + 'ï¼ˆ' +
                        days[now.getDay()] + 'ï¼‰ ' +
                        String(now.getHours()).padStart(2, '0') + ':' +
                        String(now.getMinutes()).padStart(2, '0') + ':' +
                        String(now.getSeconds()).padStart(2, '0');
      document.getElementById('clock').textContent = formatted;
    }
    setInterval(updateClock, 1000);
    // è‡ªå‹•æ¯ 5 åˆ†é˜åˆ·æ–°
    
    // ä»¥ä¸‹æ˜¯ä¸»è¿´åœˆï¼Œæ¯ç§’æª¢æŸ¥æ™‚é–“æ˜¯å¦é€²å…¥åƒåœ¾è»Šæˆ–æ¸…æƒæ¨¡å¼
    
    // æ¯ 10 åˆ†é˜å¼·åˆ¶é‡æ–°æ•´ç†é é¢ï¼Œä¸¦åŠ ä¸Š query string é¿å…å¿«å–
    setInterval(() => {
   location.href = location.pathname + '?t=' + new Date().getTime();
    }, 5 * 60 * 1000);
    updateClock();

    
    // è¼‰å…¥ Google Sheets å…¬é–‹ csv æª”æ¡ˆï¼Œæ‹†å‡ºæ¯åˆ—çš„å‰å¾Œæ¬„ä½
    fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vT4vzU7xZk5cwgUvNLxqjcDwn5ZnZ63o3XH8r5kK7oTvKQPSDjTezBWQbS-4wfyACro_-kCgJ1iNfFt/pub?output=csv')
      .then(response => response.text())
      .then(csvText => {
        const rows = csvText.trim().split('\n').map(row => row.replace(/^\ufeff/, ''));
        const lines = rows.map(row => {
          const commaIndex = row.indexOf(",");
          if (commaIndex === -1) return [row, ""];
          return [row.slice(0, commaIndex).trim(), row.slice(commaIndex + 1).trim()];
        });

        const container = document.getElementById('announcement-area');
        container.innerHTML = '';
        let marqueeParts = [];

        lines.forEach((columns, index) => {
          const page = document.createElement('div');
          page.className = 'page';
          if (index === 0) page.classList.add('active');
          page.textContent = columns[0];
          container.appendChild(page);
          if (columns[1]) {
            marqueeParts.push(columns[1]);
          }
        });

        const marquee = document.getElementById('marquee-text');
        if (marquee) {
          marquee.textContent = marqueeParts.join(' âœ¦ ') || 'ã€€';
        }

        const pages = document.querySelectorAll('.page');
        let pageIndex = 0;
        
    // ä»¥ä¸‹æ˜¯ä¸»è¿´åœˆï¼Œæ¯ç§’æª¢æŸ¥æ™‚é–“æ˜¯å¦é€²å…¥åƒåœ¾è»Šæˆ–æ¸…æƒæ¨¡å¼
    setInterval(() => {
          pages[pageIndex].classList.remove('active');
          pageIndex = (pageIndex + 1) % pages.length;
          pages[pageIndex].classList.add('active');
        }, 3000);
      });

    const bgImgs = document.querySelectorAll('.background img');
    let bgIndex = 0;
    
    // ä»¥ä¸‹æ˜¯ä¸»è¿´åœˆï¼Œæ¯ç§’æª¢æŸ¥æ™‚é–“æ˜¯å¦é€²å…¥åƒåœ¾è»Šæˆ–æ¸…æƒæ¨¡å¼
    setInterval(() => {
      bgImgs[bgIndex].classList.remove('active');
      bgIndex = (bgIndex + 1) % bgImgs.length;
      bgImgs[bgIndex].classList.add('active');
    }, 5000);

    
    // ä»¥ä¸‹æ˜¯ä¸»è¿´åœˆï¼Œæ¯ç§’æª¢æŸ¥æ™‚é–“æ˜¯å¦é€²å…¥åƒåœ¾è»Šæˆ–æ¸…æƒæ¨¡å¼
    setInterval(() => {
      const now = new Date();
      const h = now.getHours();
      const m = now.getMinutes();
      const isGarbageTime = h === 12 && m === 20;
      const garbageDiv = document.getElementById("garbage-mode");
      const music = document.getElementById("garbage-music");
      const allContent = document.body.querySelectorAll("body > *:not(#garbage-mode):not(#cleaning-mode)");

      if (isGarbageTime) {
        garbageDiv.style.display = "flex";
        allContent.forEach(el => el.style.display = "none");
        if (music && music.paused) {
            music.muted = false;
            music.play().catch(() => console.log("éŸ³æ¨‚æ’­æ”¾è¢«é˜»æ“‹"));
            }

      } else {
        garbageDiv.style.display = "none";
        allContent.forEach(el => el.style.display = "");
        if (music && !music.paused) {
          music.pause();
          music.currentTime = 0;
        }
      }
    
      // æ¸…æƒåœ–ç‰‡æ¨¡å¼ï¼š14:51 ~ 15:05
      const isCleaningTime = (h === 14 && m >= 51) || (h === 15 && m <= 5);
      const cleaningDiv = document.getElementById("cleaning-mode");

      if (isCleaningTime) {
        cleaningDiv.style.display = "flex";
        if (!garbageDiv || garbageDiv.style.display !== "flex") {
          allContent.forEach(el => el.style.display = "none");
        }
      } else {
        cleaningDiv.style.display = "none";
        if (!garbageDiv || garbageDiv.style.display !== "flex") {
          allContent.forEach(el => el.style.display = "");
        }
      }

    }, 1000);
  </script>

  
  <!-- æ¸…æƒæ¨¡å¼å€å¡Šï¼šåœ¨ 14:51~15:05 é¡¯ç¤ºæ¸…æƒåœ–ç‰‡ï¼Œä¸æ’­æ”¾éŸ³æ¨‚ -->
  <div id="cleaning-mode"  style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:black; z-index:998; justify-content:center; align-items:center;">
    <img src="cleaning_time.png" alt="æ¸…æƒæé†’" style="max-width:80%; height:auto;">
  </div>

</body>
</html>
